<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>Standardizing post references</title>
    <link rel="stylesheet" href="../static/css/heapindex.css" type="text/css" />
    <link rel="shortcut icon" href="../static/images/heap.png">
  </head>
  <body >
    <h1 id="header">Standardizing post references</h1>


<div class="post-box"><!-- post hh/888 -->
<div class="post-summary" id="post-summary-hh-888">
<span class="author">Csaba Hoch</span>
<span class="subject">Standardizing post references</span>
<span class="tags">[post references, prop, reviewed]</span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-888">&lt;hh/888&gt;</a></span>
<span class="date">(2009-11-08)</span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-934">hh/934</a>,&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1151">hh/1151</a></span>
<pre class="post-body-content">We used several forms to point to a particular post. I have no strong
preference, but I propose this form:

<span class="raw-block">    [1] hh/1234
</span>
A more extended form would be the following:

<span class="raw-block">    [1] hh/1234 Any text here
        Or even here
</span>
(I'll explain how should I use this in a separate post. [1])

Alternative forms:

<span class="raw-block">    [1] heap://hh/1234
    [1] hh://1234
</span>
After agreeing on a canonical form and before separating UMS and HH we
should make every post use that form. (Otherwise the references will
not be moved correctly.) When we do that, every post should be
referred as being in the "ums" heap, because at that point that is the
only heap that exists.

[1] <a href="../hh/thread_889.html#post-summary-hh-889">heap://hh/889</a>
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/934 -->
<div class="post-summary" id="post-summary-hh-934">
<span class="author">Csaba Hoch</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-934">&lt;hh/934&gt;</a></span>
<span class="date">(2009-11-15)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-888">hh/888</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1057">hh/1057</a></span>
<pre class="post-body-content"><span class="meta-text">[open]</span>

Also, we should not forget about printing the values of the
"Reference" tags of post files. The old Generator had this feature,
the new does not have it yet.
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1057 -->
<div class="post-summary" id="post-summary-hh-1057">
<span class="author">Attila Nagy</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1057">&lt;hh/1057&gt;</a></span>
<span class="date">(2010-01-28)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-934">hh/934</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1064">hh/1064</a></span>
<pre class="post-body-content">It seems that the `Reference` header field is still not printed in the
current top-of-the-tree branches (`hcs/_v0.4` and
`hcs/_several_heaps`).
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1064 -->
<div class="post-summary" id="post-summary-hh-1064">
<span class="author">Csaba Hoch</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1064">&lt;hh/1064&gt;</a></span>
<span class="date">(2010-01-29)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1057">hh/1057</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1073">hh/1073</a></span>
<pre class="post-body-content">Oh, I forgot about this one! I'll do it.
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1073 -->
<div class="post-summary" id="post-summary-hh-1073">
<span class="author">Csaba Hoch</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1073">&lt;hh/1073&gt;</a></span>
<span class="date">(2010-01-31)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1064">hh/1064</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1075">hh/1075</a></span>
<pre class="post-body-content">Is it OK if references will not be printed in 0.4, only in 0.5?
The _several_heaps branch (that will go into 0.5) contains a major
refactoring, and I don't want to implement this feature both in the
pre-refactoring and post-refactoring code.
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1075 -->
<div class="post-summary" id="post-summary-hh-1075">
<span class="author">Attila Nagy</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1075">&lt;hh/1075&gt;</a></span>
<span class="date">(2010-01-31)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1073">hh/1073</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1392">hh/1392</a></span>
<pre class="post-body-content"><span class="quote"><span class="quote-1">&gt; Is it OK if references will not be printed in 0.4, only in 0.5?
</span></span>
Sure, it's not that important.
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1392 -->
<div class="post-summary" id="post-summary-hh-1392">
<span class="author">Csaba Hoch</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1392">&lt;hh/1392&gt;</a></span>
<span class="date">(2010-09-19)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1075">hh/1075</a></span>
<span class="container-button post-summary-button">Children:&nbsp;-</span>
<pre class="post-body-content"><span class="meta-text">[close]</span>

I will close this subissue opened in <a href="../hh/thread_888.html#post-summary-hh-934">heap://hh/934</a> (about displaying
the Reference attribute in hkgen/hkweb), because according to
<a href="../hh/thread_1190.html#post-summary-hh-1190">heap://hh/1190</a>, the Reference attribute was removed. We will have an
"Original parent" attribute instead (see <a href="../hh/thread_1190.html#post-summary-hh-1332">heap://hh/1332</a>). Displaying
that attribute in hkgen/hkweb is considered part of <a href="../hh/thread_1190.html#post-summary-hh-1190">heap://hh/1190</a>.
</pre></div><!-- post-summary -->
</div><!-- postbox for post hh/1392 -->
</div><!-- postbox for post hh/1075 -->
</div><!-- postbox for post hh/1073 -->
</div><!-- postbox for post hh/1064 -->
</div><!-- postbox for post hh/1057 -->
</div><!-- postbox for post hh/934 -->

<div class="post-box"><!-- post hh/1151 -->
<div class="post-summary" id="post-summary-hh-1151">
<span class="author">Attila Nagy</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1151">&lt;hh/1151&gt;</a></span>
<span class="date">(2010-02-11)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-888">hh/888</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1166">hh/1166</a></span>
<pre class="post-body-content"><span class="quote"><span class="quote-1">&gt; Alternative forms:
&gt;
</span></span><span class="quote"><span class="quote-1"><span class="raw-block">&gt;     [1] heap://hh/1234
</span></span></span>
I would have supported this form, but I didn't have time to answer,
and you used the other form (&lt;heap_id&gt;/&lt;post_index&gt;) in so many posts,
that I chose to accept it.

I prefer this form because it can easily be found in the post bodies.
You seem to have a similar thought in hh/2556 .

If we think of moving posts between heaps and updating references, the
obvious solution would be simple textual search and replace. E.g. if
we move post "1234" on "heapa" to "heapb", where it will have the post
index "5678", we could simply replace all occurences of "heapa/1234"
to "heapb/5678".

But it's not always this simple. What if "heapa" is large, and there
is also a post called "heapa/12341"? (It doesn't even have to be large
as post indices are arbitrary.) We could rule that post references
should be space-delimited. (I've been putting a space between post
refs and any following punctuation because of this.)

Since post indices are arbitrary, they could even contain spaces.
That'd be even more nasty; if we used an URI-like form, we could
use URL escaping for such cases (then, a space would be "%20").

It should be easy to find post references in bodies. If we use the
slash notation, we can find postrefs like this:
- find names of heaps followed by a slash
- get the letter after the slash
- is what we have a correct post id?
- if not, add the next letter, if it's permitted as part of a post
  index [1]
- examine what we have now; if it's the post id of an existing post,
  it's a candidate
- repeat (go back to adding another letter)
- when we finish this, we'll take the longest candidate as the final
post id.

While this could be used, it would make finding post references
computationally intensive. It would be much easier if we could find
postrefs without checking for existing posts. A form like

<span class="raw-block">    heap://hh/1234
</span>
would have exactly this property.

[1] Besides whitespace, punctuation should be disallowed as well, so
that we could write e.g. "I found it in heapa://1234." In general,
since the form is URI-like, the same set of characters should be
allowed as in URIs.
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1166 -->
<div class="post-summary" id="post-summary-hh-1166">
<span class="author">Csaba Hoch</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1166">&lt;hh/1166&gt;</a></span>
<span class="date">(2010-02-13)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1151">hh/1151</a></span>
<span class="container-button post-summary-button">Children:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1393">hh/1393</a></span>
<pre class="post-body-content"><span class="quote"><span class="quote-2">&gt;&gt; Alternative forms:
&gt;&gt;
</span></span><span class="quote"><span class="quote-2"><span class="raw-block">&gt;&gt;     [1] heap://hh/1234
</span></span></span><span class="quote"><span class="quote-1">&gt;
&gt; I would have supported this form, but I didn't have time to answer,
&gt; and you used the other form (&lt;heap_id&gt;/&lt;post_index&gt;) in so many posts,
&gt; that I chose to accept it.
&gt;
&gt; I prefer this form because it can easily be found in the post bodies.
</span></span>
You just convinced me to accept this form :) What do you say?

We still have a "great post review" over ourselves, in which we review
all posts. We could convert my notation into this one. (We could
convert most of them with a script, something that you described, and
the rest by hand when we review the posts.)

<span class="quote"><span class="quote-1">&gt; If we think of moving posts between heaps and updating references, the
&gt; obvious solution would be simple textual search and replace.
</span></span>
That's not the solution I planned to use. I wanted to parse the
references in the footnotes. But your solution is both easier to do
and better. It is easier because we could get away without some form of
post parsing, and better because it will not miss references in the
body (which I have deliberately avoided so far).

My only question is: is it OK if post ids are interpreted in block
text? If not, we have to do some post parsing anyway. It would go with
"it is OK now, but we will change it later".
</pre></div><!-- post-summary -->

<div class="post-box"><!-- post hh/1393 -->
<div class="post-summary" id="post-summary-hh-1393">
<span class="author">Csaba Hoch</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_888.html#post-summary-hh-1393">&lt;hh/1393&gt;</a></span>
<span class="date">(2010-09-19)</span>
<span class="container-button post-summary-button">Parent:&nbsp;<a href="../hh/thread_888.html#post-summary-hh-1166">hh/1166</a></span>
<span class="container-button post-summary-button">Children:&nbsp;-</span>
<pre class="post-body-content"><span class="meta-text">[close]</span>

We accepted the "heap://hh/1234" form.
</pre></div><!-- post-summary -->
</div><!-- postbox for post hh/1393 -->
</div><!-- postbox for post hh/1166 -->
</div><!-- postbox for post hh/1151 -->
</div><!-- postbox for post hh/888 -->

  </body>
</html>
