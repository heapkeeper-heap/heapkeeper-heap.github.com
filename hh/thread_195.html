<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Thread hh/195</title>
    <link rel=stylesheet href="../heapindex.css" type="text/css">
  </head>
  <body>
    <h1 id="header">Thread hh/195</h1>


<div class="postbox"><!-- post hh/195 -->
<span class="postsummary" id="post_hh/195">
<span class="author">Csaba Hoch</span>
<span class="subject">Simple scripts: documentation, grep (2009-05-10 b99f4dc212)</span>
<span class="tags">[commit]</span>
<span class="index"><a href="../hh/thread_195.html#post_hh/195">&lt;hh/195&gt;</a></span>
<span class="parent">&lt;root&gt;</span>
<span class="date">(2009-05-10)</span>
<div class="body">
<pre class="postbody">--------------------------------- scripts/stat ---------------------------------
  +#!/bin/bash
  +
  +./hkshell 'on("t")' "for i in range($2): $1()" 'q()' | grep "^$1" | cut -d " " -f 2 | scripts/stat.py

  ------------------------------- scripts/stat.py -------------------------------
  +#!/usr/bin/python
  +
  +import sys
  +
  +nums = []
  +count = 0
  +avg = 0
  +sd = 0
  +
  +for x in sys.stdin:
  +    x = float(x)
  +    nums.append(x)
  +    avg += x
  +    count += 1
  +
  +avg /= count
  +
  +for x in nums:
  +    d = x - avg
  +    sd += d * d
  +
  +sd /= count - 1
  +
  +print "average: %f, SD: %f" % (avg, sd)

== Documentation ==

Could you provide a little info on how to use new scripts when you
commit them? You don't need to write normal documentation, but you
could have written a small example at least in the commit message.
(Which could be copied in the documentation later.) Something like
this would have been enough:

  The scripts/stat script executes the given hkshell command given
  times.

  An example:

    $ scripts/stat gp 5
    average: 0.000153, SD: 0.000000

  In the example, the gp() command is executed 5 times. Afterwards,
  the the result of the measurement is printed: the average executing
  time of the gp() commands was 0.000153 seconds, while the square
  deviation was 0.000000.

Don't be afraid that writing longer commit messages is a waste of
time, I will read all them happily :) It takes you 1 minute to write a
commit message like this, and it save me 5 minutes of thinking about
what were you doing.

Or it would be even better if the script printed a help text when
invoked with "--help", like I did in scripts/pushdoc. (I have just
corrected pushdoc -- I have just realized that its handling of
"--help" was buggy :) )

== Minor improvement idea ==

  --------------------------------- scripts/stat ---------------------------------
  +  #!/bin/bash
  +
  +  ./hkshell 'on("t")' "for i in range($2): $1()" 'q()' | grep "^$1" | cut -d " " -f 2 | scripts/stat.py

I would write

    grep "^$1:"

instead of

    grep "^$1"

You never know :)
</pre></div>
</span><!-- postsummary -->

<div class="postbox"><!-- post hh/203 -->
<span class="postsummary" id="post_hh/203">
<span class="author">Attila Nagy</span>
<span class="subject"><span class="star">&mdash;</span></span>
<span class="index"><a href="../hh/thread_195.html#post_hh/203">&lt;hh/203&gt;</a></span>
<span class="parent"><a href="../hh/thread_195.html#post_hh/195">&lt;&uarr;hh/195&gt;</a></span>
<span class="date">(2009-05-10)</span>
<div class="body">
<pre class="postbody">OK, help included. Also updated the maths: it now calculates the
standard deviation, not the squared deviation. (Not that it matters
much to me.)
</pre></div>
</span><!-- postsummary -->
</div><!-- postbox for post hh/203 -->
</div><!-- postbox for post hh/195 -->

  </body>
</html>
